---
title: "My first R Notebook"
author: "Celine Hernandez, Claire Toffano-Nioche, Thomas Denecker"
date: "29/06/2021"
runtime : shiny
output: 
  html_notebook: 
    toc: yes
    number_sections: yes
    theme: cerulean
---


> Goal: Load FastQC results and display summary tables and plots

# Step 0: Load the fastqcr package

fastqcr : R package to (run and) load FastQC files

Documentation : http://www.sthda.com/english/wiki/fastqcr-an-r-package-facilitating-quality-controls-of-sequencing-data-for-large-numbers-of-samples
```{r}
library(fastqcr)
```

```{r}
# Adapt the path between double quotes as needed
folderRes <-  "./Data"
```

# Step 1: Load the zip files generated by FastQC

fastqcr will look into a folder for zip files (outputs from FastQC).

```{r}
qc <- qc_aggregate(folderRes)
```

# Step 2 : Display global summaries of what was loaded

Display the content of the object where all the information was loaded by fastqcr
```{r}
qc
```

Then, general statistics for all samples
```{r}
qc_stats(qc)
```

Tests performed by FastQC on all samples
```{r}
summary(qc)
```

# Step 3 : focus on one sample

List all zip files in the specified folder
```{r}
all.results <- list.files(path=folderRes, pattern="*.zip", full.names=TRUE)
selectInput("filename", 
            label = "Which file?",
            choices = all.results, selected = all.results[1])
```

```{r echo = FALSE}
renderPlot({
  qc_plot(input$filename, "Basic Statistics")
})
```

Display one of the plots
```{r echo = FALSE}
renderPlot({
  qc_plot(input$filename, "Per base sequence quality")
})
```


